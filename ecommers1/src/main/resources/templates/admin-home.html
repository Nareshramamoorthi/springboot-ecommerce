<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>
<header>
    <h1>Ecommerce Shop - Admin Panel ðŸš€</h1>
    <nav>
        <a th:href="@{/admin/home}">Home</a>
        <a href="#about">About</a>
        <a href="#service">Service</a>

        <!-- POST logout form -->
        <form th:action="@{/logout}" method="post" style="display:inline;">
            <button type="submit" class="logout-btn">Logout</button>
        </form>
    </nav>
</header>


<main>

    <!-- Add / Edit Product Section -->
    <section>
        <h2 th:text="${product.productId} != null ? 'Edit Product' : 'Add Product'"></h2>

        <form th:action="@{${product.productId} != null ? '/admin/products/update/' + ${product.productId} : '/admin/addProduct'}"
              th:object="${product}" method="post" enctype="multipart/form-data">

            <input type="text" th:field="*{name}" placeholder="Product Name" required>
            <input type="number" step="0.01" th:field="*{price}" placeholder="Price" required>
            <input type="number" th:field="*{stock}" placeholder="Stock" required>
            <textarea th:field="*{description}" placeholder="Description"></textarea>

            <!-- Image Upload -->
            <input type="file" name="imageFile" accept="image/*">

            <!-- Show existing image when editing -->
            <div th:if="${product.imagelink != null}">
                <p>Current Image:</p>
                <img th:src="@{/images/{img}(img=${product.imagelink})}" width="100"/>
            </div>

            <button type="submit" th:text="${product.productId} != null ? 'Update Product' : 'Add Product'"></button>
        </form>
    </section>

    <!-- Product List -->
    <section>
        <h2>Product List</h2>
        <table>
            <tr>
                <th>ID</th><th>Name</th><th>Price</th><th>Stock</th><th>Image</th><th>Action</th>
            </tr>
            <tr th:each="p : ${products}">
                <td th:text="${p.productId}"></td>
                <td th:text="${p.name}"></td>
                <td th:text="${p.price}"></td>
                <td th:text="${p.stock}"></td>
                <td>
                    <img th:if="${p.imagelink != null}" th:src="@{/images/{img}(img=${p.imagelink})}" width="80"/>
                </td>
                <td>
                    <a th:href="@{'/admin/products/edit/' + ${p.productId}}">Edit</a> |
                    <a th:href="@{'/admin/products/delete/' + ${p.productId}}"
                       onclick="return confirm('Are you sure you want to delete this product?');">Delete</a>
                </td>
            </tr>
        </table>
    </section>

    <!-- User List -->
    <section>
        <h2>User List</h2>
        <table>
            <tr>
                <th>ID</th><th>Name</th><th>Email</th><th>Role</th><th>Action</th>
            </tr>
            <tr th:each="u : ${users}">
                <td th:text="${u.id}"></td>
                <td th:text="${u.name}"></td>
                <td th:text="${u.email}"></td>
                <td th:text="${u.role}"></td>
                <td>
                    <a th:href="@{'/admin/deleteUser/' + ${u.id}}"
                       onclick="return confirm('Delete this user?');">Delete</a>
                </td>
            </tr>
        </table>
    </section>

    <!-- About Section -->
    <section id="about">
        <h2>About</h2>
        <p>Welcome to the Ecommerce Shop Admin Panel. Manage your products and users with ease and efficiency. This panel allows you to update product details, track inventory, and oversee user management seamlessly.</p>
    </section>

    <!-- Service Section -->
    <section id="service">
        <h2>Service</h2>
        <p>Our platform provides professional ecommerce management services, including real-time analytics, product control, and user management. Enhance your online store experience and streamline operations.</p>
    </section>

</main>

<footer>
    <p>&copy; 2025 Ecommerce Shop | Admin Panel</p>
</footer>

</body>
</html>
